<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.AppVersionMapper">
    
    <resultMap type="AppVersion" id="AppVersionResult">
        <result property="id"    column="id"    />
        <result property="versionCode"    column="version_code"    />
        <result property="versionName"    column="version_name"    />
        <result property="apkFilePath"    column="apk_file_path"    />
        <result property="isForceUpdate"    column="is_force_update"    />
        <result property="updateContent"    column="update_content"    />
        <result property="downloadCount"    column="download_count"    />
        <result property="status"    column="status"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateTime"    column="update_time"    />
        <result property="deleted"    column="deleted"    />

    </resultMap>

    <sql id="selectAppVersionVo">
        select id, version_code, version_name, apk_file_path,deleted,  is_force_update, update_content, download_count, status, create_time, update_time from app_version
    </sql>

    <select id="selectAppVersionList" parameterType="AppVersion" resultMap="AppVersionResult">
        <include refid="selectAppVersionVo"/>
        <where>
            deleted = 0
            <if test="versionCode != null "> and version_code = #{versionCode}</if>
            <if test="versionName != null  and versionName != ''"> and version_name like concat('%', #{versionName}, '%')</if>
            <if test="apkFilePath != null  and apkFilePath != ''"> and apk_file_path = #{apkFilePath}</if>
            <if test="isForceUpdate != null "> and is_force_update = #{isForceUpdate}</if>
            <if test="updateContent != null  and updateContent != ''"> and update_content = #{updateContent}</if>
            <if test="downloadCount != null "> and download_count = #{downloadCount}</if>
            <if test="status != null "> and status = #{status}</if>
        </where>
    </select>
    
    <select id="selectAppVersionById" parameterType="Long" resultMap="AppVersionResult">
        <include refid="selectAppVersionVo"/>
        where deleted = 0 and id = #{id}
    </select>

    <insert id="insertAppVersion" parameterType="AppVersion" useGeneratedKeys="true" keyProperty="id">
        insert into app_version
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="versionCode != null">version_code,</if>
            <if test="versionName != null and versionName != ''">version_name,</if>
            <if test="apkFilePath != null and apkFilePath != ''">apk_file_path,</if>
            <if test="isForceUpdate != null">is_force_update,</if>
            <if test="updateContent != null">update_content,</if>
            <if test="downloadCount != null">download_count,</if>
            <if test="status != null">status,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="deleted != null">deleted,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="versionCode != null">#{versionCode},</if>
            <if test="versionName != null and versionName != ''">#{versionName},</if>
            <if test="apkFilePath != null and apkFilePath != ''">#{apkFilePath},</if>
            <if test="isForceUpdate != null">#{isForceUpdate},</if>
            <if test="updateContent != null">#{updateContent},</if>
            <if test="downloadCount != null">#{downloadCount},</if>
            <if test="status != null">#{status},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="deleted != null">#{deleted},</if>
         </trim>
    </insert>

    <update id="updateAppVersion" parameterType="AppVersion">
        update app_version
        <trim prefix="SET" suffixOverrides=",">
            <if test="versionCode != null">version_code = #{versionCode},</if>
            <if test="versionName != null and versionName != ''">version_name = #{versionName},</if>
            <if test="apkFilePath != null and apkFilePath != ''">apk_file_path = #{apkFilePath},</if>
            <if test="isForceUpdate != null">is_force_update = #{isForceUpdate},</if>
            <if test="updateContent != null">update_content = #{updateContent},</if>
            <if test="downloadCount != null">download_count = #{downloadCount},</if>
            <if test="status != null">status = #{status},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="deleted != null">deleted = #{deleted},</if>

        </trim>
        where id = #{id}
    </update>

    <delete id="deleteAppVersionById" parameterType="Long">
        update app_version set deleted = 1 where id = #{id}
    </delete>

    <delete id="deleteAppVersionByIds" parameterType="String">
        update app_version set deleted = 1 where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>

    </delete>
</mapper>